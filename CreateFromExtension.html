{% extends "base.html" %}
{% block title %}CreateFromExtension{% endblock %}
{% block head_content %}
<link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
{% endblock %}

{% block content %}
<script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript" src="js/markerclusterer.js"></script>
<script type="text/javascript" src="js/jquery.ui.map.js"></script>
<script type="text/javascript" src="js/jquery-ui.min.js"></script>

<script>
function validateForm() {
    var mName = $('#stream_name').val();

    if (mName === ''){
        toastr.error('Stream name cannot be empty');
        return false;
    }

    return true;

}

</script>

<!--<div id="alert"></div>-->
<div class="panel panel-default">
    <div class="panel-heading">Add a Image to a Stream</div>
    <div class="panel-body">
        <form id="createForm" action="/create" method="post" onsubmit="return validateForm()">
            <div class="form-group col-xs-6">
                <input type="text" id="stream_name" name="name" class="form-control" placeholder="Stream to Add to">
                <label>Name of the stream</label>
            </div>
            <div class="col-xs-12">
                <div class="map-surrounding">
                    <div id="map_canvas" class="map" style="width:600px;height:400px"></div>
                    <p id="markerLocation"><p>
                </div>
                <br>
            </div>

            <div class="form-group col-xs-12">
                <input id="lat" type="hidden"></input>
                <input id="lng" type="hidden"></input>
                <button type="submit" id="submit_btn" class="btn btn-primary"><i class="glyphicon glyphicon-plus"></i> Submit</button>
            </div>
        </form>
    </div>
</div>
<script type="text/javascript">
var my_marker;
$('#map_canvas').gmap({'zoom': 2, 'disableDefaultUI':true}).bind('init', function(event, map) {
	$(map).click( function(event) {
    if (!my_marker){
      $('#map_canvas').gmap('addMarker', {
  			'position': event.latLng,
  			'draggable': true,
  			'bounds': false
  		}, function(map, marker) {
        my_marker = marker;
  			$('#markerLocation').text(marker.getPosition());
        $('#lat').val(marker.getPosition().lat);
        $('#lng').val(marker.getPosition().lng);
  		});
    }
    else{
      $('#map_canvas').gmap('clear', 'markers');
      $('#map_canvas').gmap('addMarker', {
  			'position': event.latLng,
  			'draggable': true,
  			'bounds': false
  		}, function(map, marker) {
        my_marker = marker;
  			$('#markerLocation').text(marker.getPosition());
        $('#lat').val(marker.getPosition().lat);
        $('#lng').val(marker.getPosition().lng);
  		});
    }

	});
});

</script>

{% endblock %}
